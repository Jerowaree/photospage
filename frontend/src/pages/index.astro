---
import Layout from '../layouts/Layout.astro';
import { getPhotos } from '../lib/api';

// Fetch featured photos for hero showcase
let featuredPhotos: Awaited<ReturnType<typeof getPhotos>>['data']['photos'] = [];
try {
  const res = await getPhotos({ featured: true, limit: 6 });
  featuredPhotos = res.data.photos;
} catch {
  // API offline during build — use empty array
}
---

<Layout title="Aldryck — Fotografía" description="Portfolio fotográfico de Aldryck. Fotografía editorial y artística de alta calidad.">

  <!-- ─── Hero ─────────────────────────────────────────────── -->
  <section class="relative min-h-[92vh] flex flex-col items-center justify-center px-8 overflow-hidden">

    <!-- Ambient background image (first featured photo) -->
    {featuredPhotos[0] && (
      <div class="absolute inset-0 -z-10">
        <img
          src={featuredPhotos[0].url}
          alt=""
          class="w-full h-full object-cover opacity-10"
          loading="eager"
        />
        <div class="absolute inset-0 bg-gradient-to-b from-stone-50/60 via-transparent to-stone-50" />
      </div>
    )}

    <!-- Section label -->
    <p
      class="section-label mb-8 opacity-0 animate-fade-in"
      style="animation-delay:200ms; animation-fill-mode:forwards"
    >
      Portfolio Fotográfico
    </p>

    <!-- Editorial heading -->
    <h1
      class="heading-editorial text-center max-w-3xl opacity-0 animate-fade-up"
      style="animation-delay:400ms; animation-fill-mode:forwards"
    >
      El mundo<br />
      <em>a través de mi lente</em>
    </h1>

    <!-- Subtitle -->
    <p
      class="mt-8 text-stone-500 font-light text-sm tracking-widest uppercase max-w-xs text-center
             opacity-0 animate-fade-up"
      style="animation-delay:600ms; animation-fill-mode:forwards"
    >
      Editorial · Retrato · Paisaje
    </p>

    <!-- CTA -->
    <div
      class="mt-14 flex gap-4 opacity-0 animate-fade-up"
      style="animation-delay:800ms; animation-fill-mode:forwards"
    >
      <a href="/gallery" class="btn-primary">Ver trabajo</a>
      <a href="mailto:contacto@aldryck.com" class="btn-ghost">Contáctame</a>
    </div>

    <!-- Scroll indicator -->
    <div class="absolute bottom-10 left-1/2 -translate-x-1/2 flex flex-col items-center gap-2 opacity-40">
      <span class="text-xs tracking-widest uppercase text-stone-400">Desplazar</span>
      <span class="w-px h-12 bg-stone-300" />
    </div>
  </section>

  <!-- ─── Featured Grid ─────────────────────────────────────── -->
  {featuredPhotos.length > 0 && (
    <section class="px-8 py-24">
      <div class="max-w-7xl mx-auto">
        <div class="flex items-end justify-between mb-12">
          <div>
            <p class="section-label mb-3">Trabajo selecto</p>
            <h2 class="font-serif text-4xl font-light text-stone-900">Destacado</h2>
          </div>
          <a href="/gallery" class="nav-link hidden md:inline">Ver todo →</a>
        </div>

        <!-- Asymmetric editorial grid -->
        <div class="grid grid-cols-12 grid-rows-2 gap-3 h-[70vh]">
          {featuredPhotos.slice(0, 5).map((photo, i) => (
            <a
              href={`/gallery/${photo.category}`}
              class:list={[
                'group relative overflow-hidden bg-stone-100',
                i === 0 && 'col-span-7 row-span-2',
                i === 1 && 'col-span-5',
                i === 2 && 'col-span-3',
                i === 3 && 'col-span-2',
                i === 4 && 'col-span-5 row-span-1',
              ]}
              transition:name={`photo-${photo.id}`}
            >
              <img
                src={photo.thumbnailUrl}
                alt={photo.title}
                loading="lazy"
                class="w-full h-full object-cover transition-transform duration-700 ease-elegant
                       group-hover:scale-105"
              />
              <div class="absolute inset-0 bg-stone-900/0 group-hover:bg-stone-900/30
                          transition-colors duration-500 flex items-end p-6">
                <span class="text-white font-serif text-xl font-light opacity-0
                             group-hover:opacity-100 transition-opacity duration-300 translate-y-2
                             group-hover:translate-y-0">
                  {photo.title}
                </span>
              </div>
            </a>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- ─── About strip ───────────────────────────────────────── -->
  <section class="px-8 py-20 border-t border-stone-100">
    <div class="max-w-4xl mx-auto grid md:grid-cols-2 gap-16 items-center">
      <div>
        <p class="section-label mb-6">Acerca de</p>
        <p class="font-serif text-3xl font-light leading-relaxed text-stone-800">
          “La fotografía es el arte del tiempo congelado: la capacidad de guardar emociones
          y sentimientos dentro de un encuadre.”
        </p>
      </div>
      <div class="text-stone-500 font-light text-sm leading-relaxed space-y-4">
        <p>
          Entre las montañas y el mar, Aldryck captura los momentos silenciosos que
          definen una vida: la suave luz de una mañana de invierno, la geometría del
          silencio urbano, la emoción auténtica de la conexión humana.
        </p>
        <p>
          Disponible para encargos editoriales, sesiones de retrato y proyectos de
          paisaje en todo el mundo.
        </p>
        <a href="mailto:contacto@aldryck.com" class="btn-ghost mt-6 inline-flex">
          Solicitar un proyecto
        </a>
      </div>
    </div>
  </section>

</Layout>
